"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[152],{152:(e,a,s)=>{s.r(a),s.d(a,{default:()=>d});var t=s(43),r=s(352),i=s(462),n=s(326),c=s(528),l=s(579);const o=e=>{const a=Number(e);return Number.isFinite(a)?a:0};function d(){const[e,a]=(0,t.useState)([]),[s,d]=(0,t.useState)(""),[m,u]=(0,t.useState)(""),[h,x]=(0,t.useState)(!0),p=(0,r.Zp)(),{isAdmin:j,initialized:b,refresh:g}=(0,c.A)(),f=(0,t.useCallback)(async()=>{x(!0);try{const e=await i.n.productos.list();a(e),d("")}catch(e){d(e.message||"No se pudo cargar el inventario.")}finally{x(!1)}},[]);(0,t.useEffect)(()=>{b?j?f():p("/login"):g().catch(()=>{})},[b,j,f,p,g]);const N=(0,t.useCallback)(async e=>{if(window.confirm("Eliminar producto?"))try{await i.n.productos.del(e),await f()}catch(a){d(a.message||"No se pudo eliminar el producto.")}},[f]),v=m.trim().toLowerCase(),y=v?e.filter(e=>{var a;return[null===(a=e.id)||void 0===a?void 0:a.toString(),e.nombre,e.descripcion,e.categoria].some(e=>String(null!==e&&void 0!==e?e:"").toLowerCase().includes(v))}):e,w=v.length>0;return(0,l.jsx)("main",{className:"flex-grow-1",children:(0,l.jsxs)("div",{className:"container-fluid px-4 py-5",children:[(0,l.jsx)("h1",{className:"mb-4 mt-4",children:"Gesti\xf3n de Inventario"}),(0,l.jsxs)("div",{className:"row g-3 align-items-center mb-4",children:[(0,l.jsx)("div",{className:"col-12 col-md-8",children:(0,l.jsxs)("form",{className:"input-group",role:"search",onSubmit:e=>e.preventDefault(),children:[(0,l.jsx)("span",{className:"input-group-text bg-dark text-white border-secondary",children:(0,l.jsx)("i",{className:"fa-solid fa-magnifying-glass","aria-hidden":"true"})}),(0,l.jsx)("input",{type:"search",className:"form-control",placeholder:"Buscar por nombre, descripcion o categoria",value:m,onChange:e=>u(e.target.value),"aria-label":"Buscar producto en inventario"})]})}),(0,l.jsx)("div",{className:"col-12 col-md-4 d-grid d-md-flex justify-content-md-end",children:(0,l.jsxs)(r.N_,{to:"/admin/productos/nuevo",className:"btn btn-success","aria-label":"A\xf1adir nuevo producto o servicio al inventario",children:[(0,l.jsx)("i",{className:"fa-solid fa-plus me-2","aria-hidden":"true"}),"A\xf1adir Producto/Servicio"]})})]}),s&&(0,l.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[(0,l.jsx)("i",{className:"fa-solid fa-exclamation-triangle me-2","aria-hidden":"true"}),s]}),h?(0,l.jsxs)("div",{className:"text-center py-5",children:[(0,l.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Cargando productos..."})}),(0,l.jsx)("p",{className:"mt-3 text-muted",children:"Cargando inventario..."})]}):(0,l.jsx)("div",{className:"table-responsive tabla-productos-wrapper mt-3",children:(0,l.jsxs)("table",{className:"table table-dark table-striped table-bordered","aria-label":"Tabla de productos del inventario",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",children:"ID"}),(0,l.jsx)("th",{scope:"col",children:"Nombre"}),(0,l.jsx)("th",{scope:"col",children:"Precio"}),(0,l.jsx)("th",{scope:"col",children:"Descripci\xf3n"}),(0,l.jsx)("th",{scope:"col",children:"Categor\xeda"}),(0,l.jsx)("th",{scope:"col",children:"Stock"}),(0,l.jsx)("th",{scope:"col",children:"Imagen"}),(0,l.jsx)("th",{scope:"col",children:"Acciones"})]})}),(0,l.jsxs)("tbody",{children:[y.map(e=>{const a=o(e.stock),s=e.imagen_url||"/fitter_logo.png";return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:e.id}),(0,l.jsx)("td",{children:e.nombre}),(0,l.jsx)("td",{children:(0,n.A)(e.precio)}),(0,l.jsx)("td",{children:e.descripcion||""}),(0,l.jsx)("td",{children:e.categoria||""}),(0,l.jsx)("td",{children:a}),(0,l.jsx)("td",{children:(0,l.jsx)("img",{src:s,alt:e.nombre,style:{width:60,height:60,objectFit:"cover",borderRadius:6}})}),(0,l.jsx)("td",{className:"text-center align-middle",children:(0,l.jsxs)("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[(0,l.jsx)(r.N_,{to:"/admin/productos/".concat(e.id,"/editar"),className:"btn btn-warning btn-action","aria-label":"Editar ".concat(e.nombre),title:"Editar",children:(0,l.jsx)("i",{className:"fa-solid fa-pen-to-square","aria-hidden":"true"})}),(0,l.jsx)("button",{className:"btn btn-danger btn-action",onClick:()=>N(e.id),"aria-label":"Eliminar ".concat(e.nombre),title:"Eliminar",children:(0,l.jsx)("i",{className:"fa-solid fa-trash-can","aria-hidden":"true"})})]})})]},e.id)}),0===y.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:8,className:"text-center",children:w?"Sin coincidencias":"Sin productos"})})]})]})}),!h&&y.length>0&&(0,l.jsxs)("div",{className:"mt-3 text-muted small",children:[(0,l.jsx)("i",{className:"fa-solid fa-box me-2","aria-hidden":"true"}),"Mostrando ",y.length," de ",e.length," producto",1!==e.length?"s":""]})]})})}},326:(e,a,s)=>{s.d(a,{A:()=>r});const t=new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}),r=e=>{if(null===e||void 0===e)return t.format(0);const a="number"===typeof e?e:Number.parseFloat(e);if(!Number.isFinite(a))return t.format(0);const s=Math.round(a);return t.format(s)}}}]);
//# sourceMappingURL=152.24e151c7.chunk.js.map