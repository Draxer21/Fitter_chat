"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[239],{239:(e,l,a)=>{a.r(l),a.d(l,{default:()=>d});var o=a(43),s=a(352),t=a(528),n=a(964),r=a(579);const i=e=>(e||"").trim();function d(){const e=(0,s.Zp)(),[l]=(0,s.ok)(),{t:a}=(0,n.Ym)(),{user:d,isAuthenticated:c,login:u,logout:m,initialized:g,authenticating:h}=(0,t.A)(),[p,x]=(0,o.useState)(""),[v,j]=(0,o.useState)(""),[b,f]=(0,o.useState)(""),[N,C]=(0,o.useState)(""),[w,k]=(0,o.useState)(!1),[y,T]=(0,o.useState)(""),[S,P]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(g&&c){const a=l.get("next");a&&e(a,{replace:!0})}},[g,c,e,l]);return(0,r.jsx)("main",{children:(0,r.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"67.5vh"},children:(0,r.jsxs)("div",{className:"container mt-5 border mx-auto",style:{backgroundColor:"rgba(0,0,0,.904)",width:500,borderRadius:13,color:"white"},children:[(0,r.jsx)("h2",{className:"text-center m-4",children:a("login.title")}),c?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{children:[a("login.loggedInAs"),": ",(0,r.jsx)("strong",{children:(null===d||void 0===d?void 0:d.full_name)||(null===d||void 0===d?void 0:d.username)||"Usuario"})]}),(0,r.jsx)("button",{className:"btn btn-light",onClick:async()=>{await m()},children:a("login.logout")})]}):(0,r.jsxs)("form",{className:"w-50 mx-auto",onSubmit:async o=>{o.preventDefault(),T("");const s=i(p).toLowerCase(),t=i(v);if(s&&t)try{P(!0);const a={};b&&(a.totp=b),N&&(a.backupCode=N),await u(s,t,a),x(""),j(""),f(""),C(""),k(!1);const o=l.get("next");e(o||"/admin/productos",{replace:!0})}catch(r){var n;null!==r&&void 0!==r&&null!==(n=r.payload)&&void 0!==n&&n.mfa_required?(k(!0),T("Se requiere un c\xf3digo TOTP o uno de tus c\xf3digos de respaldo para completar el ingreso.")):T((null===r||void 0===r?void 0:r.message)||a("login.credentials.invalid"))}finally{P(!1)}else T(a("login.required"))},children:[(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{htmlFor:"loginUsername",children:a("login.username.label")}),(0,r.jsx)("input",{id:"loginUsername",className:"form-control","aria-invalid":Boolean(y),value:p,onChange:e=>x(e.target.value),placeholder:a("login.username.placeholder"),autoComplete:"username",required:!0})]}),(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{htmlFor:"loginPassword",children:a("login.password.label")}),(0,r.jsx)("input",{type:"password",id:"loginPassword",className:"form-control","aria-invalid":Boolean(y),value:v,onChange:e=>j(e.target.value),placeholder:a("login.password.placeholder"),autoComplete:"current-password",required:!0})]}),(w||b||N)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{htmlFor:"loginTotp",children:"C\xf3digo TOTP"}),(0,r.jsx)("input",{id:"loginTotp",className:"form-control",value:b,onChange:e=>f(e.target.value),placeholder:"Ingresa el c\xf3digo de tu app autenticadora",autoComplete:"one-time-code"})]}),(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{htmlFor:"loginBackup",children:"C\xf3digo de respaldo"}),(0,r.jsx)("input",{id:"loginBackup",className:"form-control",value:N,onChange:e=>C(e.target.value),placeholder:"\xdasalo si no tienes acceso al TOTP",autoComplete:"off"}),(0,r.jsx)("small",{className:"form-text text-muted",children:"Puedes dejarlo vac\xedo si usar\xe1s el c\xf3digo TOTP."})]})]}),(0,r.jsxs)("div",{className:"text-center mb-2",children:[(0,r.jsxs)("span",{children:[a("login.noAccount")," "]}),(0,r.jsx)(s.N_,{to:"/registro",children:a("login.gotoRegister")})]}),y&&(0,r.jsx)("div",{className:"alert alert-danger mt-2",role:"alert","aria-live":"assertive",children:y}),(0,r.jsx)("div",{className:"d-flex justify-content-center m-3",children:(0,r.jsx)("button",{type:"submit",className:"btn",style:{backgroundColor:"black",color:"white",borderColor:"rgba(255,255,255,.568)"},disabled:S||h,children:a(S||h?"login.loading":"login.submit")})})]})]})})})}}}]);
//# sourceMappingURL=239.45ffa7ad.chunk.js.map