{"version":3,"file":"static/js/347.9592c50d.chunk.js","mappings":"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","sources":["pages/AccountSecurityPage.jsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../contexts/AuthContext\";\r\nimport \"../styles/account-security.css\";\r\n\r\nconst formatDateTime = (isoString) => {\r\n  if (!isoString) return \"—\";\r\n  try {\r\n    const date = new Date(isoString);\r\n    if (Number.isNaN(date.getTime())) {\r\n      return isoString;\r\n    }\r\n    return date.toLocaleString();\r\n  } catch (err) {\r\n    return isoString;\r\n  }\r\n};\r\n\r\nexport default function AccountSecurityPage() {\r\n  const {\r\n    isAuthenticated,\r\n    mfa,\r\n    loadMfaStatus,\r\n    startMfaSetup,\r\n    confirmMfa,\r\n    disableMfa,\r\n  } = useAuth();\r\n  const [totpCode, setTotpCode] = useState(\"\");\r\n  const [disableTotp, setDisableTotp] = useState(\"\");\r\n  const [disableBackup, setDisableBackup] = useState(\"\");\r\n  const [infoMessage, setInfoMessage] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [recoveryCodes, setRecoveryCodes] = useState([]);\r\n  const isMfaEnabled = Boolean(mfa?.enabled);\r\n  const backupRemaining = mfa?.backupCodesLeft ?? 0;\r\n\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      loadMfaStatus().catch(() => {});\r\n    } else {\r\n      setRecoveryCodes([]);\r\n    }\r\n  }, [isAuthenticated, loadMfaStatus]);\r\n\r\n  useEffect(() => {\r\n    if (Array.isArray(mfa?.recoveryCodes)) {\r\n      setRecoveryCodes(mfa.recoveryCodes);\r\n    }\r\n  }, [mfa?.recoveryCodes]);\r\n\r\n  const setupInProgress = useMemo(() => Boolean(mfa?.secret || mfa?.otpauthUrl), [mfa?.secret, mfa?.otpauthUrl]);\r\n\r\n  const handleStartSetup = async () => {\r\n    setInfoMessage(\"\");\r\n    setErrorMessage(\"\");\r\n    try {\r\n      await startMfaSetup();\r\n      setInfoMessage(\"Escanea el código QR o ingresa la clave secreta en tu app autenticadora y luego confirma con un código TOTP.\");\r\n      setTotpCode(\"\");\r\n    } catch (err) {\r\n      setErrorMessage(err?.message || \"No fue posible iniciar la configuración.\");\r\n    }\r\n  };\r\n\r\n  const handleConfirm = async (event) => {\r\n    event.preventDefault();\r\n    setInfoMessage(\"\");\r\n    setErrorMessage(\"\");\r\n    try {\r\n      const result = await confirmMfa(totpCode.trim());\r\n      const codes = result?.recoveryCodes || [];\r\n      setRecoveryCodes(codes);\r\n      setTotpCode(\"\");\r\n      setInfoMessage(\"Autenticación multifactor activada. Guarda tus códigos de respaldo en un lugar seguro.\");\r\n    } catch (err) {\r\n      setErrorMessage(err?.message || \"No pudimos verificar el código. Intenta nuevamente.\");\r\n    }\r\n  };\r\n\r\n  const handleDisable = async (event) => {\r\n    event.preventDefault();\r\n    setInfoMessage(\"\");\r\n    setErrorMessage(\"\");\r\n    if (!disableTotp && !disableBackup) {\r\n      setErrorMessage(\"Ingresa un código TOTP o uno de respaldo para continuar.\");\r\n      return;\r\n    }\r\n    try {\r\n      await disableMfa({ code: disableTotp.trim(), backupCode: disableBackup.trim() });\r\n      setDisableTotp(\"\");\r\n      setDisableBackup(\"\");\r\n      setInfoMessage(\"Autenticación multifactor desactivada.\");\r\n    } catch (err) {\r\n      setErrorMessage(err?.message || \"No pudimos desactivar MFA. Revisa el código e inténtalo de nuevo.\");\r\n    }\r\n  };\r\n\r\n  const handleRefresh = () => {\r\n    loadMfaStatus().catch((err) => {\r\n      setErrorMessage(err?.message || \"No se pudo actualizar el estado MFA.\");\r\n    });\r\n  };\r\n\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <main className=\"account-security-page py-5\">\r\n        <div className=\"container account-security-shell\">\r\n          <div className=\"row justify-content-center\">\r\n            <div className=\"col-lg-6\">\r\n              <div className=\"alert alert-warning shadow-lg border-0 rounded-4\">\r\n                Necesitas iniciar sesión para gestionar la autenticación de dos factores.\r\n                <div className=\"mt-3\">\r\n                  <Link className=\"btn btn-dark\" to=\"/login\">\r\n                    Ir al inicio de sesión\r\n                  </Link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"account-security-page py-5\">\r\n      <div className=\"container account-security-shell\">\r\n        <div className=\"row justify-content-center\">\r\n          <div className=\"col-xl-8 col-lg-9\">\r\n            <section className=\"security-hero mb-4\">\r\n              <span className=\"security-hero__badge\">MFA</span>\r\n              <div>\r\n                <h1 className=\"mb-3\">Seguridad de la cuenta</h1>\r\n                <p className=\"security-hero__lead mb-0\">\r\n                  Activa la autenticación de dos factores (MFA) para proteger tu cuenta con un código adicional generado por una app (Authy, Google Authenticator, 1Password, etc.).\r\n                </p>\r\n              </div>\r\n              <div className=\"security-hero__status\">\r\n                <span className={`status-pill ${isMfaEnabled ? \"status-pill--on\" : \"status-pill--off\"}`}>\r\n                  {isMfaEnabled ? \"Protección activa\" : \"Protección pendiente\"}\r\n                </span>\r\n                <p className=\"status-note mb-0\">\r\n                  {isMfaEnabled ? `Códigos de respaldo disponibles: ${backupRemaining}` : \"Añade una capa extra de seguridad con MFA.\"}\r\n                </p>\r\n              </div>\r\n            </section>\r\n\r\n          {infoMessage && <div className=\"alert alert-success\">{infoMessage}</div>}\r\n          {errorMessage && <div className=\"alert alert-danger\">{errorMessage}</div>}\r\n          {mfa?.error && !errorMessage && <div className=\"alert alert-danger\">{mfa.error.message || \"Error consultando MFA.\"}</div>}\r\n\r\n          <section className=\"card shadow-sm mb-4 security-card\">\r\n            <div className=\"card-body\">\r\n              <div className=\"security-state\">\r\n                <div>\r\n                  <p className=\"overline mb-1\">Estado actual</p>\r\n                  <div className=\"d-flex flex-column flex-sm-row align-items-sm-center gap-2\">\r\n                    <span className={`status-pill ${isMfaEnabled ? \"status-pill--on\" : \"status-pill--off\"}`}>\r\n                      {isMfaEnabled ? \"Activado\" : \"Desactivado\"}\r\n                    </span>\r\n                    <span className=\"security-state__hint\">\r\n                      {isMfaEnabled ? \"Tus inicios de sesión tienen doble verificación.\" : \"Activa MFA para blindar tu cuenta.\"}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n                <button type=\"button\" className=\"btn btn-outline-secondary btn-sm\" onClick={handleRefresh} disabled={mfa?.loading}>\r\n                  {mfa?.loading ? \"Actualizando...\" : \"Actualizar estado\"}\r\n                </button>\r\n              </div>\r\n              <div className=\"security-state__meta\">\r\n                <div>\r\n                  <p className=\"meta-label\">Última activación</p>\r\n                  <p className=\"meta-value\">{formatDateTime(mfa?.enabledAt)}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"meta-label\">Códigos de respaldo</p>\r\n                  <p className=\"meta-value\">{backupRemaining}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </section>\r\n\r\n          {!isMfaEnabled && (\r\n            <section className=\"card shadow-sm mb-4 security-card\">\r\n              <div className=\"card-body\">\r\n                <h5 className=\"card-title\">Activar MFA</h5>\r\n                <p className=\"text-muted\">\r\n                  Es necesario escanear un código QR o ingresar la clave secreta en tu aplicación autenticadora antes de confirmar.\r\n                </p>\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn-dark mb-3\"\r\n                  onClick={handleStartSetup}\r\n                  disabled={mfa?.loading}\r\n                >\r\n                  {setupInProgress ? \"Reiniciar configuración\" : \"Generar clave secreta\"}\r\n                </button>\r\n\r\n                {setupInProgress && (\r\n                  <div className=\"qr-setup-panel mb-3\">\r\n                    <h6>Clave secreta</h6>\r\n                    <code style={{ wordBreak: \"break-all\" }}>{mfa?.secret || \"—\"}</code>\r\n                    {mfa?.otpauthUrl && (\r\n                      <div className=\"mt-3\">\r\n                        <h6>Escanea el código QR</h6>\r\n                        <img\r\n                          src={`https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=${encodeURIComponent(mfa.otpauthUrl)}`}\r\n                          alt=\"QR para autenticar MFA\"\r\n                          width={180}\r\n                          height={180}\r\n                        />\r\n                        <div className=\"small text-muted mt-2\">\r\n                          Si prefieres, abre el enlace directamente:{\" \"}\r\n                          <a href={mfa.otpauthUrl} target=\"_blank\" rel=\"noreferrer\">\r\n                            {mfa.otpauthUrl}\r\n                          </a>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    <form className=\"mt-3\" onSubmit={handleConfirm}>\r\n                      <div className=\"mb-3\">\r\n                        <label htmlFor=\"confirmTotp\" className=\"form-label\">Código TOTP</label>\r\n                        <input\r\n                          id=\"confirmTotp\"\r\n                          className=\"form-control\"\r\n                          value={totpCode}\r\n                          onChange={(event) => setTotpCode(event.target.value)}\r\n                          placeholder=\"Introduce un código de 6 dígitos\"\r\n                          autoComplete=\"one-time-code\"\r\n                          required\r\n                        />\r\n                      </div>\r\n                      <button type=\"submit\" className=\"btn btn-success\" disabled={mfa?.loading}>\r\n                        Confirmar activación\r\n                      </button>\r\n                    </form>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {isMfaEnabled && (\r\n            <section className=\"card shadow-sm mb-4 security-card\">\r\n              <div className=\"card-body\">\r\n                <h5 className=\"card-title\">Desactivar MFA</h5>\r\n                <p className=\"text-muted\">\r\n                  Para desactivar la autenticación multifactor ingresa un código TOTP vigente o uno de tus códigos de respaldo.\r\n                </p>\r\n                <form onSubmit={handleDisable}>\r\n                  <div className=\"row g-3\">\r\n                    <div className=\"col-md-6\">\r\n                      <label htmlFor=\"disableTotp\" className=\"form-label\">Código TOTP</label>\r\n                      <input\r\n                        id=\"disableTotp\"\r\n                        className=\"form-control\"\r\n                        value={disableTotp}\r\n                        onChange={(event) => setDisableTotp(event.target.value)}\r\n                        placeholder=\"Código de 6 dígitos\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"col-md-6\">\r\n                      <label htmlFor=\"disableBackup\" className=\"form-label\">Código de respaldo</label>\r\n                      <input\r\n                        id=\"disableBackup\"\r\n                        className=\"form-control\"\r\n                        value={disableBackup}\r\n                        onChange={(event) => setDisableBackup(event.target.value)}\r\n                        placeholder=\"Ingresa un código de respaldo válido\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"mt-3\">\r\n                    <button type=\"submit\" className=\"btn btn-outline-danger\" disabled={mfa?.loading}>\r\n                      Desactivar MFA\r\n                    </button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {Array.isArray(recoveryCodes) && recoveryCodes.length > 0 && (\r\n            <section className=\"card shadow-sm security-card\">\r\n              <div className=\"card-body\">\r\n                <h5 className=\"card-title\">Códigos de respaldo</h5>\r\n                <p className=\"text-muted\">\r\n                  Guarda estos códigos en un lugar seguro. Cada uno puede utilizarse una sola vez cuando no tengas acceso a tu app autenticadora.\r\n                </p>\r\n                <ol className=\"recovery-code-list\">\r\n                  {recoveryCodes.map((code) => (\r\n                    <li key={code}>\r\n                      <code>{code}</code>\r\n                    </li>\r\n                  ))}\r\n                </ol>\r\n              </div>\r\n            </section>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </main>\r\n  );\r\n}\r\n"],"names":["formatDateTime","isoString","date","Date","Number","isNaN","getTime","toLocaleString","err","AccountSecurityPage","_mfa$backupCodesLeft","isAuthenticated","mfa","loadMfaStatus","startMfaSetup","confirmMfa","disableMfa","useAuth","totpCode","setTotpCode","useState","disableTotp","setDisableTotp","disableBackup","setDisableBackup","infoMessage","setInfoMessage","errorMessage","setErrorMessage","recoveryCodes","setRecoveryCodes","isMfaEnabled","Boolean","enabled","backupRemaining","backupCodesLeft","useEffect","catch","Array","isArray","setupInProgress","useMemo","secret","otpauthUrl","_jsx","className","children","_jsxs","concat","error","message","type","onClick","handleRefresh","disabled","loading","enabledAt","async","style","wordBreak","src","encodeURIComponent","alt","width","height","href","target","rel","onSubmit","event","preventDefault","result","trim","codes","htmlFor","id","value","onChange","placeholder","autoComplete","required","code","backupCode","length","map","Link","to"],"sourceRoot":""}