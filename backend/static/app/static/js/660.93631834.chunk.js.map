{"version":3,"file":"static/js/660.93631834.chunk.js","mappings":"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","sources":["utils/formatPrice.js","pages/CatalogPage.jsx"],"sourcesContent":["const pesoFormatter = new Intl.NumberFormat(\"es-CL\", {\r\n  style: \"currency\",\r\n  currency: \"CLP\",\r\n  minimumFractionDigits: 0,\r\n  maximumFractionDigits: 0,\r\n});\r\n\r\nexport const formatearPrecio = (valor) => {\r\n  if (valor === null || valor === undefined) {\r\n    return pesoFormatter.format(0);\r\n  }\r\n\r\n  const numero = typeof valor === \"number\" ? valor : Number.parseFloat(valor);\r\n  if (!Number.isFinite(numero)) {\r\n    return pesoFormatter.format(0);\r\n  }\r\n\r\n  const normalizado = Math.round(numero);\r\n  return pesoFormatter.format(normalizado);\r\n};\r\n\r\nexport const formatPrice = formatearPrecio;\r\n","import { useEffect, useMemo, useState } from \"react\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nimport { API } from \"../services/apijs\";\r\nimport { useCart } from \"../contexts/CartContext\";\r\nimport { formatearPrecio } from \"../utils/formatPrice\";\r\nimport \"../styles/catalog.css\";\r\n\r\nconst normalizePrice = (value) => {\r\n  const n = Number(value);\r\n  return Number.isFinite(n) && n >= 0 ? n : 0;\r\n};\r\n\r\nconst normalizeStock = (value) => {\r\n  const n = Number(value);\r\n  return Number.isFinite(n) ? n : 0;\r\n};\r\n\r\nexport default function CatalogPage() {\r\n  const location = useLocation();\r\n  const { addItem, items: cartItems, total } = useCart();\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const [search, setSearch] = useState(\"\");\r\n  const [selectedCategory, setSelectedCategory] = useState(\"all\");\r\n  const [inStockOnly, setInStockOnly] = useState(false);\r\n  const [priceFrom, setPriceFrom] = useState(\"\");\r\n  const [priceTo, setPriceTo] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    let active = true;\r\n    setLoading(true);\r\n    API.productos\r\n      .list(\"\")\r\n      .then((data) => {\r\n        if (!active) return;\r\n        setProducts(Array.isArray(data) ? data : []);\r\n        setError(\"\");\r\n      })\r\n      .catch((err) => {\r\n        if (!active) return;\r\n        setError(err?.message || \"No se pudieron cargar los productos.\");\r\n      })\r\n      .finally(() => {\r\n        if (!active) return;\r\n        setLoading(false);\r\n      });\r\n    return () => {\r\n      active = false;\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const params = new URLSearchParams(location.search);\r\n    const cat = params.get(\"categoria\");\r\n    if (cat) {\r\n      setSelectedCategory(cat);\r\n    }\r\n    const q = params.get(\"q\");\r\n    if (q) {\r\n      setSearch(q);\r\n    }\r\n  }, [location.search]);\r\n\r\n  const categories = useMemo(() => {\r\n    const set = new Set();\r\n    products.forEach((p) => {\r\n      if (p?.categoria) {\r\n        set.add(p.categoria);\r\n      }\r\n    });\r\n    return Array.from(set).sort();\r\n  }, [products]);\r\n\r\n  const priceLimits = useMemo(() => {\r\n    if (!products.length) {\r\n      return { min: 0, max: 0 };\r\n    }\r\n    const values = products.map((p) => normalizePrice(p.precio)).filter((n) => Number.isFinite(n));\r\n    if (!values.length) {\r\n      return { min: 0, max: 0 };\r\n    }\r\n    return { min: Math.min(...values), max: Math.max(...values) };\r\n  }, [products]);\r\n\r\n  useEffect(() => {\r\n    if (priceLimits.min === 0 && priceLimits.max === 0) {\r\n      setPriceFrom(\"\");\r\n      setPriceTo(\"\");\r\n    } else {\r\n      setPriceFrom(priceLimits.min.toString());\r\n      setPriceTo(priceLimits.max.toString());\r\n    }\r\n  }, [priceLimits.min, priceLimits.max]);\r\n\r\n  const filteredProducts = useMemo(() => {\r\n    const minPrice = normalizePrice(priceFrom);\r\n    const maxPrice = normalizePrice(priceTo);\r\n    const hasSearch = search.trim().length > 0;\r\n    const searchLower = search.trim().toLowerCase();\r\n\r\n    return products.filter((product) => {\r\n      if (!product) {\r\n        return false;\r\n      }\r\n      if (selectedCategory !== \"all\" && product.categoria !== selectedCategory) {\r\n        return false;\r\n      }\r\n      const price = normalizePrice(product.precio);\r\n      if (priceFrom !== \"\" && price < minPrice) {\r\n        return false;\r\n      }\r\n      if (priceTo !== \"\" && maxPrice !== 0 && price > maxPrice) {\r\n        return false;\r\n      }\r\n      if (inStockOnly && normalizeStock(product.stock) <= 0) {\r\n        return false;\r\n      }\r\n      if (hasSearch) {\r\n        const text = `${product.nombre || \"\"} ${product.descripcion || \"\"}`.toLowerCase();\r\n        if (!text.includes(searchLower)) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    });\r\n  }, [products, selectedCategory, priceFrom, priceTo, inStockOnly, search]);\r\n\r\n  const addToCart = async (id) => {\r\n    try {\r\n      await addItem(id);\r\n    } catch (err) {\r\n      alert(err?.message || \"No se pudo agregar al carrito.\");\r\n    }\r\n  };\r\n\r\n  const totalItems = cartItems.reduce((acc, item) => acc + (item.cantidad || 0), 0);\r\n\r\n  return (\r\n    <main className=\"catalog-layout container-fluid py-4\">\r\n      <div className=\"row justify-content-center\">\r\n        <div className=\"col-12 col-xl-10\">\r\n          <div className=\"catalog-grid\">\r\n            <aside className=\"catalog-filters\">\r\n              <h2>Filtros</h2>\r\n              <div className=\"catalog-filter-group\">\r\n                <label htmlFor=\"catalog-search\">Buscar</label>\r\n                <input\r\n                  id=\"catalog-search\"\r\n                  type=\"text\"\r\n                  className=\"form-control\"\r\n                  placeholder=\"Nombre o descripción\"\r\n                  value={search}\r\n                  onChange={(event) => setSearch(event.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"catalog-filter-group\">\r\n                <label htmlFor=\"catalog-category\">Categoría</label>\r\n                <select\r\n                  id=\"catalog-category\"\r\n                  className=\"form-select\"\r\n                  value={selectedCategory}\r\n                  onChange={(event) => setSelectedCategory(event.target.value)}\r\n                >\r\n                  <option value=\"all\">Todas</option>\r\n                  {categories.map((cat) => (\r\n                    <option key={cat} value={cat}>\r\n                      {cat}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n              <div className=\"catalog-filter-group\">\r\n                <label className=\"form-label\">Rango de precio</label>\r\n                <div className=\"d-flex gap-2\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    className=\"form-control\"\r\n                    value={priceFrom}\r\n                    onChange={(event) => setPriceFrom(event.target.value)}\r\n                    placeholder={`Desde ${priceLimits.min}`}\r\n                  />\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    className=\"form-control\"\r\n                    value={priceTo}\r\n                    onChange={(event) => setPriceTo(event.target.value)}\r\n                    placeholder={`Hasta ${priceLimits.max}`}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"form-check mt-3\">\r\n                <input\r\n                  className=\"form-check-input\"\r\n                  type=\"checkbox\"\r\n                  id=\"catalog-stock\"\r\n                  checked={inStockOnly}\r\n                  onChange={(event) => setInStockOnly(event.target.checked)}\r\n                />\r\n                <label className=\"form-check-label\" htmlFor=\"catalog-stock\">\r\n                  Solo productos con stock\r\n                </label>\r\n              </div>\r\n            </aside>\r\n\r\n            <section className=\"catalog-products\">\r\n              <header className=\"catalog-products__header\">\r\n                <div>\r\n                  <h1>Catálogo de productos</h1>\r\n                  <p className=\"text-muted mb-0\">\r\n                    {loading\r\n                      ? \"Cargando productos...\"\r\n                      : `${filteredProducts.length} de ${products.length} productos`}\r\n                  </p>\r\n                </div>\r\n              </header>\r\n\r\n              {error && <div className=\"alert alert-danger\">{error}</div>}\r\n              {!loading && !error && filteredProducts.length === 0 && (\r\n                <div className=\"alert alert-info\">No encontramos productos que coincidan con tu búsqueda.</div>\r\n              )}\r\n\r\n              <div className=\"catalog-products__grid\">\r\n                {filteredProducts.map((product) => {\r\n                  const stock = normalizeStock(product.stock);\r\n                  const outOfStock = stock <= 0;\r\n                  const image = product.imagen_url || \"/fitter_logo.png\";\r\n                  return (\r\n                    <article key={product.id} className=\"catalog-card\">\r\n                      <Link to={`/producto/${product.id}`} className=\"catalog-card__image\">\r\n                        <img src={image} alt={product.nombre} loading=\"lazy\" />\r\n                        {product.categoria && <span className=\"catalog-card__badge\">{product.categoria}</span>}\r\n                      </Link>\r\n                      <div className=\"catalog-card__body\">\r\n                        <h3>{product.nombre}</h3>\r\n                        <p className=\"catalog-card__description\">{product.descripcion || \"Sin descripción\"}</p>\r\n                        {product.rating && (\r\n                          <div className=\"catalog-card__rating\">\r\n                            <span className=\"catalog-card__stars\">\r\n                              {\"★\".repeat(Math.round(product.rating))}{product.rating < 5 ? \"☆\".repeat(5 - Math.round(product.rating)) : \"\"}\r\n                            </span>\r\n                            <span>{Number(product.rating).toFixed(1)}</span>\r\n                            {product.rating_count ? <span className=\"text-muted\">({product.rating_count})</span> : null}\r\n                          </div>\r\n                        )}\r\n                        <div className=\"catalog-card__meta\">\r\n                          <span>{formatearPrecio(product.precio)}</span>\r\n                          <span>{stock > 0 ? `${stock} en stock` : \"Sin stock\"}</span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"catalog-card__actions\">\r\n                        <Link to={`/producto/${product.id}`} className=\"btn btn-outline-secondary btn-sm catalog-card__btn\">\r\n                          Ver detalle\r\n                        </Link>\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"btn btn-dark btn-sm catalog-card__btn\"\r\n                          disabled={outOfStock}\r\n                          onClick={() => addToCart(product.id)}\r\n                        >\r\n                          {outOfStock ? \"Agotado\" : \"Añadir al carrito\"}\r\n                        </button>\r\n                      </div>\r\n                    </article>\r\n                  );\r\n                })}\r\n              </div>\r\n            </section>\r\n\r\n            <aside className=\"catalog-cart\">\r\n              <div className=\"catalog-cart__header\">\r\n                <h2>Tu carrito</h2>\r\n                <span>{totalItems} producto{totalItems === 1 ? \"\" : \"s\"}</span>\r\n              </div>\r\n              {cartItems.length === 0 ? (\r\n                <p className=\"text-muted mb-0\">No tienes productos agregados.</p>\r\n              ) : (\r\n                <ul className=\"catalog-cart__list\">\r\n                  {cartItems.map((item) => (\r\n                    <li key={item.producto_id || item.id}>\r\n                      <div>\r\n                        <strong>{item.nombre || item.producto?.nombre}</strong>\r\n                        <div className=\"text-muted small\">\r\n                          {item.cantidad} x {formatearPrecio(item.precio || item.producto?.precio || 0)}\r\n                        </div>\r\n                      </div>\r\n                      <span>{formatearPrecio((item.precio || 0) * (item.cantidad || 0))}</span>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              )}\r\n              <div className=\"catalog-cart__footer\">\r\n                <div className=\"catalog-cart__total\">\r\n                  <span>Total</span>\r\n                  <strong>{formatearPrecio(total)}</strong>\r\n                </div>\r\n                <Link to=\"/carrito\" className=\"btn btn-warning w-100\">\r\n                  Ir al carrito\r\n                </Link>\r\n              </div>\r\n            </aside>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":["pesoFormatter","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","formatearPrecio","valor","undefined","format","numero","Number","parseFloat","isFinite","normalizado","Math","round","normalizePrice","value","n","normalizeStock","CatalogPage","location","useLocation","addItem","items","cartItems","total","useCart","products","setProducts","useState","loading","setLoading","error","setError","search","setSearch","selectedCategory","setSelectedCategory","inStockOnly","setInStockOnly","priceFrom","setPriceFrom","priceTo","setPriceTo","useEffect","active","API","productos","list","then","data","Array","isArray","catch","err","message","finally","params","URLSearchParams","cat","get","q","categories","useMemo","set","Set","forEach","p","categoria","add","from","sort","priceLimits","length","min","max","values","map","precio","filter","toString","filteredProducts","minPrice","maxPrice","hasSearch","trim","searchLower","toLowerCase","product","price","stock","concat","nombre","descripcion","includes","totalItems","reduce","acc","item","cantidad","_jsx","className","children","_jsxs","htmlFor","id","type","placeholder","onChange","event","target","checked","outOfStock","image","imagen_url","Link","to","src","alt","rating","repeat","toFixed","rating_count","disabled","onClick","async","alert","addToCart","_item$producto","_item$producto2","producto","producto_id"],"sourceRoot":""}