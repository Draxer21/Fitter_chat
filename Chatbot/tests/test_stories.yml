version: "3.1"

stories:
- story: crear reserva confirmada
  steps:
  - user: |
      Quiero reservar una clase.
    intent: crear_reserva
  - action: reserva_form
  - active_loop: reserva_form
  - user: |
      Clase de spinning.
    intent: informar
    entities:
      - clase: spinning
  - slot_was_set:
      - clase: spinning
  - action: reserva_form
  - user: |
      Para el 2025-10-05.
    intent: informar
    entities:
      - fecha: "2025-10-05"
  - slot_was_set:
      - fecha: "2025-10-05"
  - action: reserva_form
  - user: |
      A las 07:00.
    intent: informar
    entities:
      - hora: "07:00"
  - slot_was_set:
      - hora: "07:00"
  - action: reserva_form
  - active_loop: null
  - action: utter_confirmar_reserva
  - user: |
      Si, confirma por favor.
    intent: afirmar
  - action: action_crear_reserva
  - action: utter_reserva_confirmada

- story: crear reserva cancelada por cliente
  steps:
  - user: |
      Necesito crear una reserva.
    intent: crear_reserva
  - action: reserva_form
  - active_loop: reserva_form
  - user: |
      Clase de yoga.
    intent: informar
    entities:
      - clase: yoga
  - slot_was_set:
      - clase: yoga
  - action: reserva_form
  - user: |
      El 2025-10-06.
    intent: informar
    entities:
      - fecha: "2025-10-06"
  - slot_was_set:
      - fecha: "2025-10-06"
  - action: reserva_form
  - user: |
      A las 18:30.
    intent: informar
    entities:
      - hora: "18:30"
  - slot_was_set:
      - hora: "18:30"
  - action: reserva_form
  - active_loop: null
  - action: utter_confirmar_reserva
  - user: |
      No, mejor cancela.
    intent: negar
  - action: utter_reserva_cancelada

- story: consultar estado reserva
  steps:
  - user: |
      Quiero saber el estado de mi reserva.
    intent: consultar_reserva
  - action: utter_ask_codigo_reserva
  - user: |
      El codigo es ABC123.
    intent: informar
    entities:
      - codigo_reserva: ABC123
  - slot_was_set:
      - codigo_reserva: ABC123
  - action: action_consultar_reserva
  - action: utter_reserva_estado

- story: rutina personalizada completada
  steps:
  - user: |
      Necesito una nueva rutina.
    intent: solicitar_rutina
  - action: rutina_form
  - active_loop: rutina_form
  - user: |
      Trabajar pecho.
    intent: informar
    entities:
      - musculo: pecho
  - slot_was_set:
      - musculo: pecho
  - action: rutina_form
  - user: |
      Soy nivel intermedio.
    intent: informar
    entities:
      - nivel: intermedio
  - slot_was_set:
      - nivel: intermedio
  - action: rutina_form
  - user: |
      Mi objetivo es fuerza.
    intent: informar
    entities:
      - objetivo: fuerza
  - slot_was_set:
      - objetivo: fuerza
  - action: rutina_form
  - user: |
      Solo tengo mancuernas.
    intent: informar
    entities:
      - equipamiento: mancuernas
  - slot_was_set:
      - equipamiento: mancuernas
  - action: rutina_form
  - user: |
      Hagamos siete ejercicios.
    intent: informar
    entities:
      - ejercicios_num: "7"
  - slot_was_set:
      - ejercicios_num: 7
  - action: rutina_form
  - user: |
      Dispongo de 45 minutos.
    intent: informar
    entities:
      - tiempo_disponible: "45"
  - slot_was_set:
      - tiempo_disponible: 45
  - action: rutina_form
  - user: |
      ninguna
    intent: informar
  - slot_was_set:
      - condiciones_salud: ninguna
  - action: rutina_form
  - user: |
      ninguna
    intent: informar
  - slot_was_set:
      - alergias: ninguna
  - action: rutina_form
  - user: |
      Prefiero verla en pantalla.
    intent: informar
    entities:
      - formato: pantalla
  - slot_was_set:
      - formato: pantalla
  - action: rutina_form
  - active_loop: null
  - action: utter_resumen_rutina
  - action: action_generar_rutina

- story: enviar rutina por correo
  steps:
  - user: |
      Envia la rutina por correo.
    intent: enviar_rutina_correo
  - action: utter_pedir_contacto
  - user: |
      Mi correo es cliente@fitter.com
    intent: informar
    entities:
      - email: cliente@fitter.com
  - slot_was_set:
      - contacto: cliente@fitter.com
  - action: utter_envio_rutina_correo

- story: cambio de plan suscripcion
  steps:
  - user: |
      Quiero cambiar al plan anual.
    intent: suscripcion_cambio_plan
  - action: action_suscripcion_cambio_plan
- story: test perfil completo
  steps:
  - user: |
      Quiero ver mi perfil
    intent: consultar_perfil
  - action: action_fetch_profile
  - action: utter_perfil_incompleto
  - user: |
      Actualizar con el bot
    intent: actualizar_perfil_bot
  - action: profile_form
  - active_loop: profile_form
  - user: |
      75
    intent: informar
  - action: profile_form
  - user: |
      180
    intent: informar
  - action: profile_form
  - active_loop: null
  - action: action_submit_profile_form

- story: cancelar profile_form
  steps:
  - user: |
      Necesito actualizar mi perfil
    intent: actualizar_perfil_bot
  - action: profile_form
  - active_loop: profile_form
  - user: |
      Mejor cancelalo
    intent: detener_formulario
  - action: utter_form_cancelado
  - action: action_deactivate_loop
  - active_loop: null

- story: generar rutina con perfil completo
  steps:
  - user: |
      Genera una rutina nueva
    intent: solicitar_rutina
  - action: action_fetch_profile
  - slot_was_set:
      - perfil_completo: true
  - action: utter_perfil_resumen
  - action: action_generar_rutina

- story: mostrar rutina en pantalla
  steps:
  - user: |
      Prefiero verla en pantalla
    intent: mostrar_rutina_pantalla
  - action: action_generar_rutina

- story: suscripcion alta
  steps:
  - user: |
      Quiero suscribirme al plan premium
    intent: suscripcion_alta
  - action: utter_suscripcion_alta

- story: suscripcion baja
  steps:
  - user: |
      Quiero darme de baja
    intent: suscripcion_baja
  - action: utter_suscripcion_baja

- story: enviar rutina alternativo
  steps:
  - user: |
      Mandala por mail por favor
    intent: enviar_rutina_correo
  - action: utter_pedir_contacto
  - user: |
      Usa mi correo altenativo@fitter.com
    intent: informar
    entities:
      - email: altenativo@fitter.com
  - slot_was_set:
      - contacto: altenativo@fitter.com
  - action: utter_envio_rutina_correo

- story: fallback fuera de alcance
  steps:
  - user: |
      me sirve para volar al espacio?
    intent: nlu_fallback
  - action: utter_fuera_de_alcance

- story: perfil form completo A
  steps:
    - user: |
        Actualizar mi perfil completo
      intent: actualizar_perfil_bot
    - action: profile_form
    - active_loop: profile_form
    - user: |
        80
      intent: informar
    - slot_was_set:
        - peso: 80
    - action: profile_form
    - user: |
        178
      intent: informar
    - slot_was_set:
        - altura: 178
    - action: profile_form
    - user: |
        ganar masa muscular
      intent: informar
    - slot_was_set:
        - objetivo_fitness: ganar masa muscular
    - action: profile_form
    - user: |
        ninguno
      intent: informar
    - slot_was_set:
        - padecimientos: ninguno
    - action: profile_form
    - user: |
        sin lactosa
      intent: informar
    - slot_was_set:
        - preferencia_dieta: sin lactosa
    - action: profile_form
    - active_loop: null
    - action: action_submit_profile_form
    - action: utter_perfil_actualizado

- story: perfil form completo B
  steps:
    - user: |
        Quiero actualizar el perfil
      intent: actualizar_perfil_bot
    - action: profile_form
    - active_loop: profile_form
    - user: |
        65
      intent: informar
    - slot_was_set:
        - peso: 65
    - action: profile_form
    - user: |
        165
      intent: informar
    - slot_was_set:
        - altura: 165
    - action: profile_form
    - user: |
        mejorar resistencia
      intent: informar
    - slot_was_set:
        - objetivo_fitness: mejorar resistencia
    - action: profile_form
    - user: |
        tengo asma leve
      intent: informar
    - slot_was_set:
        - padecimientos: tengo asma leve
    - action: profile_form
    - user: |
        vegetariana
      intent: informar
    - slot_was_set:
        - preferencia_dieta: vegetariana
    - action: profile_form
    - active_loop: null
    - action: action_submit_profile_form
    - action: utter_perfil_actualizado
