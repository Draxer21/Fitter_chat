version: "3.1"

stories:
- story: crear reserva confirmada
  steps:
  - user: |
      /crear_reserva
    intent: crear_reserva
  - action: reserva_form
  - active_loop: reserva_form
  - user: |
      /informar{"clase":"spinning"}
    intent: informar
    entities:
      - clase: spinning
  - slot_was_set:
      - clase: spinning
  - action: reserva_form
  - user: |
      /informar{"fecha":"2025-10-05"}
    intent: informar
    entities:
      - fecha: "2025-10-05"
  - slot_was_set:
      - fecha: "2025-10-05"
  - action: reserva_form
  - user: |
      /informar{"hora":"07:00"}
    intent: informar
    entities:
      - hora: "07:00"
  - slot_was_set:
      - hora: "07:00"
  - action: reserva_form
  - active_loop: null
  - action: utter_confirmar_reserva
  - user: |
      /afirmar
    intent: afirmar
  - action: action_crear_reserva
  - action: utter_reserva_confirmada

- story: crear reserva cancelada por cliente
  steps:
  - user: |
      /crear_reserva
    intent: crear_reserva
  - action: reserva_form
  - active_loop: reserva_form
  - user: |
      /informar{"clase":"yoga"}
    intent: informar
    entities:
      - clase: yoga
  - slot_was_set:
      - clase: yoga
  - action: reserva_form
  - user: |
      /informar{"fecha":"2025-10-06"}
    intent: informar
    entities:
      - fecha: "2025-10-06"
  - slot_was_set:
      - fecha: "2025-10-06"
  - action: reserva_form
  - user: |
      /informar{"hora":"18:30"}
    intent: informar
    entities:
      - hora: "18:30"
  - slot_was_set:
      - hora: "18:30"
  - action: reserva_form
  - active_loop: null
  - action: utter_confirmar_reserva
  - user: |
      /negar
    intent: negar
  - action: utter_reserva_cancelada

- story: consultar estado reserva
  steps:
  - user: |
      /consultar_reserva
    intent: consultar_reserva
  - action: utter_ask_codigo_reserva
  - user: |
      /informar{"codigo_reserva":"ABC123"}
    intent: informar
    entities:
      - codigo_reserva: ABC123
  - slot_was_set:
      - codigo_reserva: ABC123
  - action: action_consultar_reserva
  - action: utter_reserva_estado

- story: rutina personalizada completada
  steps:
  - user: |
      /solicitar_rutina
    intent: solicitar_rutina
  - action: action_fetch_profile
  - slot_was_set:
      - perfil_completo: true
  - action: action_generar_rutina
  - slot_was_set:
      - servicio_pendiente: null

- story: flujo entreno unico batman bale
  steps:
  - user: |
      /solicitar_entreno_unico{"hero_programa":"batman_bale"}
    intent: solicitar_entreno_unico
    entities:
      - hero_programa: batman_bale
  - action: hero_form
  - active_loop: hero_form
  - slot_was_set:
      - hero_programa: batman_bale
  - slot_was_set:
      - hero_inicio: proxima semana
  - slot_was_set:
      - hero_equipo: gimnasio
  - active_loop: null
  - action: action_inscribir_entreno_unico

- story: enviar rutina por correo
  steps:
  - user: |
      /enviar_rutina_correo
    intent: enviar_rutina_correo
  - action: utter_pedir_contacto
  - user: |
      /informar{"email":"cliente@fitter.com"}
    intent: informar
    entities:
      - email: cliente@fitter.com
  - slot_was_set:
      - contacto: cliente@fitter.com
  - action: utter_envio_rutina_correo

- story: cambio de plan suscripcion
  steps:
  - user: |
      /suscripcion_cambio_plan
    intent: suscripcion_cambio_plan
  - action: action_suscripcion_cambio_plan
- story: test perfil completo
  steps:
  - user: |
      /consultar_perfil
    intent: consultar_perfil
  - action: action_fetch_profile
  - user: |
      /actualizar_perfil_bot
    intent: actualizar_perfil_bot
  - action: profile_form
  - active_loop: profile_form
  - user: |
      75
    intent: informar
  - slot_was_set:
      - peso: 75
  - action: profile_form
  - user: |
      180
    intent: informar
  - slot_was_set:
      - altura: 180
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - objetivo_fitness: ganar masa muscular
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - somatotipo: no_se
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - padecimientos: ninguno
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - preferencia_dieta: sin lactosa
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - musculo_preferido: pecho
  - action: profile_form
  - active_loop: null
  - action: action_submit_profile_form

- story: cancelar profile_form
  steps:
  - user: |
      /actualizar_perfil_bot
    intent: actualizar_perfil_bot
  - action: profile_form
  - active_loop: profile_form
  - user: |
      /detener_formulario
    intent: detener_formulario
  - action: action_deactivate_loop
  - active_loop: null
  - action: utter_form_cancelado

- story: generar rutina con perfil completo
  steps:
  - user: |
      /solicitar_rutina
    intent: solicitar_rutina
  - action: action_fetch_profile
  - slot_was_set:
      - perfil_completo: true
  - action: action_generar_rutina
  - slot_was_set:
      - servicio_pendiente: null

- story: mostrar rutina en pantalla
  steps:
  - user: |
      /mostrar_rutina_pantalla
    intent: mostrar_rutina_pantalla
  - action: action_generar_rutina
  - slot_was_set:
      - servicio_pendiente: null

- story: suscripcion alta
  steps:
  - user: |
      /suscripcion_alta
    intent: suscripcion_alta
  - action: utter_suscripcion_alta

- story: suscripcion baja
  steps:
  - user: |
      /suscripcion_baja
    intent: suscripcion_baja
  - action: utter_suscripcion_baja

- story: enviar rutina alternativo
  steps:
  - user: |
      /enviar_rutina_correo
    intent: enviar_rutina_correo
  - action: utter_pedir_contacto
  - user: |
      /informar{"email":"altenativo@fitter.com"}
    intent: informar
    entities:
      - email: altenativo@fitter.com
  - slot_was_set:
      - contacto: altenativo@fitter.com
  - action: utter_envio_rutina_correo

- story: fallback fuera de alcance
  steps:
  - user: |
      /nlu_fallback
    intent: nlu_fallback
  - action: utter_fuera_de_alcance

- story: perfil form completo A
  steps:
  - user: |
      /actualizar_perfil_bot
    intent: actualizar_perfil_bot
  - action: profile_form
  - active_loop: profile_form
  - user: |
      80
    intent: informar
  - slot_was_set:
      - peso: 80
  - action: profile_form
  - user: |
      178
    intent: informar
  - slot_was_set:
      - altura: 178
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - objetivo_fitness: ganar masa muscular
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - somatotipo: no_se
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - padecimientos: ninguno
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - preferencia_dieta: sin lactosa
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - musculo_preferido: pecho
  - action: profile_form
  - active_loop: null
  - action: action_submit_profile_form

- story: perfil form completo B
  steps:
  - user: |
      /actualizar_perfil_bot
    intent: actualizar_perfil_bot
  - action: profile_form
  - active_loop: profile_form
  - user: |
      65
    intent: informar
  - slot_was_set:
      - peso: 65
  - action: profile_form
  - user: |
      165
    intent: informar
  - slot_was_set:
      - altura: 165
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - objetivo_fitness: mejorar resistencia
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - somatotipo: no_se
  - action: profile_form
  - user: |
      tengo asma leve
    intent: informar
  - slot_was_set:
      - padecimientos: tengo asma leve
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - preferencia_dieta: vegetariana
  - action: profile_form
  - user: |
      /informar
    intent: informar
  - slot_was_set:
      - musculo_preferido: espalda
  - action: profile_form
  - active_loop: null
  - action: action_submit_profile_form

- story: rutina y luego dieta en la misma sesion
  steps:
  - user: |
      /solicitar_rutina
    intent: solicitar_rutina
  - action: action_fetch_profile
  - slot_was_set:
      - perfil_completo: true
  - action: action_generar_rutina
  - slot_was_set:
      - servicio_pendiente: null
  - user: |
      /solicitar_dieta
    intent: solicitar_dieta
  - action: action_fetch_profile
  - slot_was_set:
      - perfil_completo: true
  - action: action_generar_dieta
  - slot_was_set:
      - servicio_pendiente: null

- story: dieta y luego rutina en la misma sesion
  steps:
  - user: |
      /solicitar_dieta
    intent: solicitar_dieta
  - action: action_fetch_profile
  - slot_was_set:
      - perfil_completo: true
  - action: action_generar_dieta
  - slot_was_set:
      - servicio_pendiente: null
  - user: |
      /solicitar_rutina
    intent: solicitar_rutina
  - action: action_fetch_profile
  - slot_was_set:
      - perfil_completo: true
  - action: action_generar_rutina
  - slot_was_set:
      - servicio_pendiente: null
