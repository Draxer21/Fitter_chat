version: "3.1"

intents:
  - saludar
  - despedir
  - ayuda
  - agradecimiento
  - info_servicios
  - horarios
  - precios_planes
  - privacidad
  - ubicacion
  - consejo_nutricion
  - dolor_lesion
  - sugerir_rutina          # se usará para activar rutina_form
  - resumen_rutina
  - crear_reserva
  - consultar_reserva
  - cancelar_reserva
  - suscripcion_cambio_plan
  - suscripcion_alta
  - suscripcion_baja
  - contacto_humano
  - fuera_de_alcance
  - afirmar
  - negar
  - informar
  - progreso_registrar
  - mostrar_rutina_pantalla
  - enviar_rutina_correo

entities:
  - objetivo        # hipertrofia|fuerza|bajar_grasa|resistencia
  - musculo         # pecho|espalda|piernas|hombros|brazos|core|fullbody|cardio
  - nivel           # principiante|intermedio|avanzado
  - clase           # spinning|yoga|funcional|hiit|pilates|zumba
  - fecha           # hoy|mañana|AAAA-MM-DD
  - hora            # HH:MM
  - dolor_zona      # lumbar|rodilla|hombro|codo|cuello
  - contacto        # email o teléfono (si lo capturas luego)
  - codigo_reserva

slots:
  objetivo:
    type: text
    mappings:
      - type: from_entity
        entity: objetivo
  musculo:
    type: text
    mappings:
      - type: from_entity
        entity: musculo
  nivel:
    type: text
    mappings:
      - type: from_entity
        entity: nivel
  clase:
    type: text
    mappings:
      - type: from_entity
        entity: clase
  fecha:
    type: text
    mappings:
      - type: from_entity
        entity: fecha
  hora:
    type: text
    mappings:
      - type: from_entity
        entity: hora
  dolor_zona:
    type: text
    mappings:
      - type: from_entity
        entity: dolor_zona
  codigo_reserva:
    type: text
    mappings:
      - type: from_entity
        entity: codigo_reserva
  contacto:
    type: text
    mappings:
      - type: from_entity
        entity: contacto

forms:
  rutina_form:
    required_slots:
      - musculo
      - nivel
      - objetivo
  # (opcional) si quieres asistir reserva por formulario guiado
  reserva_form:
    required_slots:
      - clase
      - fecha
      - hora

responses:
  utter_saludar:
    - text: "¡Hola! Soy tu asistente del gimnasio. ¿En qué te ayudo?"
  utter_despedir:
    - text: "¡Gracias por escribirnos! Que tengas un gran entrenamiento."
    - text: "¡Hasta luego!"
  utter_agradecimiento:
    - text: "Con gusto. ¿Algo más en que te apoye?"
  utter_ayuda:
    - text: "Puedo sugerirte rutinas, reservar clases, informar precios, horarios y más."
  utter_info_servicios:
    - text: "Contamos con rutinas personalizadas, clases dirigidas, nutrición y seguimiento de progresos."
  utter_precios_planes:
    - text: "Planes Mensual, Trimestral y Anual. ¿Quieres que te comparta el detalle por WhatsApp o correo?"
  utter_horarios:
    - text: "Lunes a viernes 06:00–22:00 y fines de semana 08:00–18:00."
  utter_ubicacion:
    - text: "Av. Ejemplo 123, piso 2. ¿Necesitas el mapa?"
  utter_contacto_humano:
    - text: "Te conecto con un asesor. Déjame teléfono o correo y el mejor horario."
  utter_privacidad:
    - text: "Tratamos tus datos según la normativa vigente. ¿Quieres ver el resumen de privacidad?"

  # ÚNICA definición (con botones)
  utter_rutina_sugerida:
    - text: "Rutina generada para {musculo} (nivel {nivel}). ¿Cómo la prefieres?"
      buttons:
        - title: "Ver en pantalla"
          payload: "/mostrar_rutina_pantalla"
        - title: "Enviar por correo"
          payload: "/enviar_rutina_correo"

  # -----------------------
  # PREGUNTAS (standard forms)
  # -----------------------
  utter_ask_objetivo:
    - text: "¿Cuál es tu objetivo? (hipertrofia, fuerza, bajar grasa, resistencia)"
  utter_ask_musculo:
    - text: "¿Qué grupo quieres trabajar? (pecho, espalda, piernas, hombros, brazos, core, fullbody, cardio)"
  utter_ask_nivel:
    - text: "¿Cuál es tu nivel? (principiante, intermedio, avanzado)"
  utter_ask_clase:
    - text: "¿Qué clase deseas reservar? (spinning, yoga, funcional, hiit, pilates, zumba)"
  utter_ask_fecha:
    - text: "¿Para qué día? (hoy, mañana o AAAA-MM-DD)"
  utter_ask_hora:
    - text: "¿A qué hora? (ej. 07:00, 19:30)"
  utter_ask_codigo_reserva:
    - text: "Por favor, indícame el código/ID de tu reserva."

  # Alias (compatibilidad con historias antiguas)
  utter_pedir_objetivo:
    - text: "¿Cuál es tu objetivo? (hipertrofia, fuerza, bajar grasa, resistencia)"
  utter_pedir_musculo:
    - text: "¿Qué grupo quieres trabajar? (pecho, espalda, piernas, hombros, brazos, core o fullbody)"
  utter_pedir_nivel:
    - text: "¿Cuál es tu nivel? (principiante, intermedio, avanzado)"
  utter_pedir_clase:
    - text: "¿Qué clase deseas reservar? (spinning, yoga, funcional, hiit, pilates, zumba)"
  utter_pedir_fecha:
    - text: "¿Para qué día? (hoy, mañana o AAAA-MM-DD)"
  utter_pedir_hora:
    - text: "¿A qué hora? (ej. 07:00, 19:30)"

  # Contacto/envío
  utter_ask_contacto:
    - text: "Indícame tu correo o teléfono para enviarte la rutina (ej. usuario@correo.com o +56 9 1234 5678)."
  utter_envio_rutina_correo:
    - text: "Perfecto, enviaré la rutina a {contacto} (demo)."

  # -----------------------
  # SALIDAS
  # -----------------------
  utter_confirmar_reserva:
    - text: "Reserva creada: {clase} el {fecha} a las {hora}."
  utter_reserva_cancelada:
    - text: "Listo, tu reserva fue cancelada."
  utter_reserva_estado:
    - text: "Tu próxima reserva es {clase} el {fecha} a las {hora}."
  utter_fuera_de_alcance:
    - text: "Esa consulta está fuera de alcance. ¿Deseas hablar con un asesor?"
  utter_reserva_confirmada:
    - text: "Reserva confirmada. Te enviaremos el comprobante a tu correo."
  utter_dolor_lesion:
    - text: "Detén el ejercicio. Si hay dolor agudo/inflamación, consulta a un profesional antes de continuar."
  utter_nutricion_consejo:
    - text: "Según tu objetivo y nivel, te recomiendo un plan equilibrado. ¿Prefieres pautas generales o un menú de 7 días?"
  utter_progreso_registrado:
    - text: "Anotado. Registré tu progreso. ¿Agregar otra métrica (peso, RM, medidas)?"
  utter_suscripcion_alta:
    - text: "Para activar la suscripción, confirma plan y método de pago."
  utter_suscripcion_baja:
    - text: "Puedo gestionar tu baja o pausar la suscripción. ¿Cómo procedemos?"
  utter_suscripcion_cambio_plan:
    - text: "¿A qué plan te gustaría cambiarte? (Mensual, Trimestral, Anual)"

actions:
  - action_consejo_nutricion
  - action_sugerir_rutina
  - action_resumen_rutina
  - action_crear_reserva
  - action_cancelar_reserva
  - action_consultar_reserva
  - action_suscripcion_cambio_plan
  # (no se declara validate_* a menos que lo implementes)

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
