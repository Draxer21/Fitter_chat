version: "3.1"

intents:
  - saludar
  - ayuda
  - informar
  - solicitar_rutina
  - solicitar_dieta
  - solicitar_entreno_unico
  - cambiar_objetivo_rutina
  - cambiar_musculo_rutina
  - cambiar_nivel_rutina
  - dolor_lesion
  - consultar_reserva
  - enviar_rutina_correo
  - mostrar_rutina_pantalla
  - suscripcion_alta
  - suscripcion_baja
  - consultar_perfil
  - actualizar_perfil
  - actualizar_perfil_bot
  - navegar_perfil_web
  - soporte_general
  - soporte_mfa
  - detener_formulario
  - nlu_fallback

entities:
  - objetivo
  - musculo
  - hero_programa
  - nivel
  - equipamiento
  - ejercicios_num
  - tiempo_disponible
  - condiciones_salud
  - alergias
  - formato
  - contacto
  - codigo_reserva

slots:
  objetivo:
    type: text
    mappings:
      - type: from_entity
        entity: objetivo

  musculo:
    type: text
    mappings:
      - type: from_entity
        entity: musculo

  nivel:
    type: text
    mappings:
      - type: from_entity
        entity: nivel

  equipamiento:
    type: text
    mappings:
      - type: from_entity
        entity: equipamiento

  ejercicios_num:
    type: text
    mappings:
      - type: from_entity
        entity: ejercicios_num

  tiempo_disponible:
    type: text
    mappings:
      - type: from_entity
        entity: tiempo_disponible

  condiciones_salud:
    type: text
    mappings:
      - type: from_entity
        entity: condiciones_salud

  alergias:
    type: text
    mappings:
      - type: from_entity
        entity: alergias

  formato:
    type: text
    mappings:
      - type: from_entity
        entity: formato

  contacto:
    type: text
    mappings:
      - type: from_entity
        entity: contacto

  codigo_reserva:
    type: text
    mappings:
      - type: from_entity
        entity: codigo_reserva

  hero_programa:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: hero_form
            requested_slot: hero_programa
      - type: from_entity
        entity: hero_programa

  hero_inicio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: hero_form
            requested_slot: hero_inicio

  hero_equipo:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: hero_form
            requested_slot: hero_equipo

  peso:
    type: float
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: profile_form
            requested_slot: peso

  altura:
    type: float
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: profile_form
            requested_slot: altura

  objetivo_fitness:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: profile_form
            requested_slot: objetivo_fitness

  padecimientos:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: profile_form
            requested_slot: padecimientos

  preferencia_dieta:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: profile_form
            requested_slot: preferencia_dieta
  musculo_preferido:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: profile_form
            requested_slot: musculo_preferido

  resumen_perfil:
    type: text
    influence_conversation: false
    mappings:
      - type: custom

  perfil_completo:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom

  servicio_pendiente:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  ultima_rutina:
    type: any
    influence_conversation: false
    mappings:
      - type: custom

  ultima_dieta:
    type: any
    influence_conversation: false
    mappings:
      - type: custom

responses:
  utter_saludar:
    - text: "¡Hola! Soy Fitter, tu compañero de entrenamiento. ¿Qué tal, amigo? ¿En qué te doy una mano hoy?"
      buttons:
        - title: "Ver mi perfil"
          payload: "/consultar_perfil"
        - title: "Generar rutina"
          payload: "/solicitar_rutina"
        - title: "Sugerir dieta"
          payload: "/solicitar_dieta"
        - title: "Soporte"
          payload: "/soporte_general"

  utter_info_servicios:
    - text: "Puedo generar rutinas, sugerir dietas, enviar planes por correo, consultar reservas y ayudarte a actualizar tu perfil. Estoy aquí para que entrenes con confianza."

  utter_dolor_lesion:
    - text: "Si notas dolor o una lesion recurrente, baja la intensidad y consulta con un profesional."

  utter_pedir_contacto:
    - text: "Genial, necesito un correo o teléfono para enviarte la rutina. ¿Me lo compartes, por fa?"

  utter_envio_rutina_correo:
    - text: "Perfecto, en unos minutos te envío la rutina a {contacto}. ¡Avísame si necesitas otro formato!"

  utter_ask_codigo_reserva:
    - text: "Indícame el código de tu reserva y te cuento el estado, amigo."

  utter_reserva_estado:
    - text: "Estado de la reserva {codigo_reserva}: actualizado y confirmado. ¿Algo más que quieras revisar?"

  utter_faq/horarios:
    - text: "Nuestro gimnasio abre de lunes a viernes de 6:00 a 22:00, sábados de 8:00 a 20:00 y domingos de 9:00 a 14:00. Si necesitas un horario especial, avísame."

  utter_faq/pagos:
    - text: "Puedes pagar con tarjetas de crédito y débito, transferencia o Mercado Pago. También tenemos cuotas sin interés en membresías trimestrales y anuales."

  utter_suscripcion_alta:
    - text: "¡Vamos con tu suscripción! Dime qué plan prefieres y el método de pago, y lo dejamos listo."

  utter_suscripcion_baja:
    - text: "Puedo cancelar o pausar tu suscripción. Cuéntame cómo prefieres proceder y lo hago enseguida."

  utter_fuera_de_alcance:
    - text: "Lo siento, aún no puedo ayudarte con eso. ¿Te parece si lo intentamos de otra manera o me das más detalles, amigo?"

  utter_perfil_resumen:
    - text: "{resumen_perfil}"

  utter_ask_musculo:
    - text: "¿Qué grupo muscular quieres entrenar? Elige una opción:" 
      buttons:
        - title: "Pecho"
          payload: "/solicitar_rutina{\"musculo\": \"pecho\"}"
        - title: "Espalda"
          payload: "/solicitar_rutina{\"musculo\": \"espalda\"}"
        - title: "Piernas"
          payload: "/solicitar_rutina{\"musculo\": \"piernas\"}"
        - title: "Hombros"
          payload: "/solicitar_rutina{\"musculo\": \"hombros\"}"
        - title: "Brazos"
          payload: "/solicitar_rutina{\"musculo\": \"brazos\"}"
        - title: "Core"
          payload: "/solicitar_rutina{\"musculo\": \"core\"}"
        - title: "Fullbody"
          payload: "/solicitar_rutina{\"musculo\": \"fullbody\"}"
        - title: "Cardio"
          payload: "/solicitar_rutina{\"musculo\": \"cardio\"}"

  utter_ask_hero_programa:
    - text: "Tengo planes temáticos Shonen Power, Ninja Agility y Mecha Endurance. ¿Cuál te interesa?"
      buttons:
        - title: "Shonen Power"
          payload: "/solicitar_entreno_unico{\"hero_programa\": \"shonen\"}"
        - title: "Ninja Agility"
          payload: "/solicitar_entreno_unico{\"hero_programa\": \"ninja\"}"
        - title: "Mecha Endurance"
          payload: "/solicitar_entreno_unico{\"hero_programa\": \"mecha\"}"

  utter_ask_hero_inicio:
    - text: "¿Cuándo quieres comenzar el plan? Puedes indicarme una fecha (ej. 2025-01-10) o decir 'la próxima semana'."

  utter_ask_hero_equipo:
    - text: "Cuéntame con qué equipamiento cuentas (casa, gimnasio, TRX, solo peso corporal). Así adapto las recomendaciones."

  utter_hero_cancelado:
    - text: "Perfecto, dejamos pendiente la selección del Entreno Único. Si quieres retomarlo, dímelo."

  utter_ask_musculo_preferido:
    - text: "¿Hay algún grupo muscular que quieras priorizar de forma habitual (pecho, espalda, piernas, hombros, brazos, core, fullbody, cardio)?"

  utter_perfil_incompleto:
    - text: "Para continuar necesito tus datos básicos (peso, altura, objetivo, padecimientos y preferencia de dieta). Dímelos uno por uno y los vamos registrando aquí mismo."

  utter_mostrar_perfil:
    - text: "Aquí tienes tu perfil: {resumen_perfil}"

  utter_link_perfil:
    - text: "Puedes actualizar tu información desde la página de perfil en https://app.fitter/perfil. Cuando termines, vuelve y dime si necesitas algo más."

  utter_perfil_actualizado:
    - text: "Perfecto, ya tengo tus datos al día. ¿Seguimos con lo que estábamos viendo o hay algo más en lo que te ayude?"

  utter_soporte_opciones:
    - text: "Dime cómo te puedo ayudar, amigo. Elige una opción y vamos al tiro:"
      buttons:
        - title: "Problemas con MFA"
          payload: "/soporte_mfa"
        - title: "Hablar con un asesor"
          payload: "/informar{\"contacto\": \"asesor\"}"

  utter_soporte_mfa:
    - text: "Si no puedes iniciar sesion con MFA, verifica la hora del dispositivo, regenera el codigo desde la app y, si es necesario, usa un codigo de respaldo o solicita uno nuevo desde tu perfil."

  utter_ask_peso:
    - text: "Cual es tu peso actual en kilogramos? Puedes aproximarlo a numeros enteros."

  utter_ask_altura:
    - text: "Cual es tu altura en centimetros?"

  utter_ask_objetivo_fitness:
    - text: "Cual es tu objetivo principal ahora mismo? (ejemplo: bajar grasa, ganar masa, rendimiento)"

  utter_ask_objetivo:
    - text: "¿Cuál es tu objetivo principal? (ej. bajar_grasa, hipertrofia, equilibrada)"

  utter_ask_padecimientos:
    - text: "Tienes alguna condicion o padecimiento que deba considerar? Si no, dime \"ninguno\"."

  utter_ask_preferencia_dieta:
    - text: "Tienes alguna preferencia o restriccion alimentaria? (ejemplo: sin lactosa, vegetariana, ninguna)"

  utter_form_cancelado:
    - text: "De acuerdo, no actualizare tu perfil por ahora. Si cambias de idea avisame."

forms:
  profile_form:
    required_slots:
      - peso
      - altura
      - objetivo_fitness
      - padecimientos
      - preferencia_dieta
      - musculo_preferido
  hero_form:
    required_slots:
      - hero_programa
      - hero_inicio
      - hero_equipo

actions:
  - action_fetch_profile
  - action_submit_profile_form
  - action_generar_rutina
  - action_generar_dieta
  - action_consultar_reserva
  - action_inscribir_entreno_unico

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
