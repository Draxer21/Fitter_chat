version: "3.1"

stories:

# ───────── BÁSICOS (one-turn) ─────────
- story: saludo
  steps:
    - intent: saludar
    - action: utter_saludar

- story: despedida
  steps:
    - intent: despedir
    - action: utter_despedir

- story: ayuda
  steps:
    - intent: ayuda
    - action: utter_info_servicios

- story: agradecimiento
  steps:
    - intent: agradecimiento
    - action: utter_agradecimiento

# ───────── INFO (one-turn) ─────────
- story: info servicios
  steps:
    - intent: info_servicios
    - action: utter_info_servicios

- story: horarios
  steps:
    - intent: horarios
    - action: utter_horarios

- story: precios
  steps:
    - intent: precios_planes
    - action: utter_precios_planes

- story: privacidad
  steps:
    - intent: privacidad
    - action: utter_privacidad

- story: ubicacion
  steps:
    - intent: ubicacion
    - action: utter_ubicacion

# ───────── NUTRICIÓN y LESIONES ─────────
- story: dolor o lesion
  steps:
    - intent: dolor_lesion
    - action: utter_dolor_lesion

- story: consejo nutricion simple
  steps:
    - intent: consejo_nutricion
    - action: action_consejo_nutricion

# ───────── RUTINAS — FORM (happy paths) ─────────
- story: rutina (form, turnos)
  steps:
    - intent: solicitar_rutina
    - action: rutina_form
    - active_loop: rutina_form
    - intent: informar
    - slot_was_set:
        - musculo: pecho
    - action: rutina_form
    - intent: informar
    - slot_was_set:
        - nivel: intermedio
    - action: rutina_form
    - intent: informar
    - slot_was_set:
        - objetivo: fuerza
    - action: rutina_form
    - intent: informar
    - slot_was_set:
        - equipamiento: mancuernas
    - action: rutina_form
    - intent: informar
    - slot_was_set:
        - ejercicios_num: 8
    - action: rutina_form
    - intent: informar
    - slot_was_set:
        - tiempo_disponible: 60
    - action: rutina_form
    - intent: formato_entrega_rutina
    - slot_was_set:
        - formato: pantalla
    - action: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina   # ← la decisión posterior la toman las reglas

- story: rutina (form, en una frase)
  steps:
    - intent: solicitar_rutina
      entities:
        - musculo: pecho
        - nivel: intermedio
        - objetivo: fuerza
        - equipamiento: mancuernas
        - ejercicios_num: "7"
        - tiempo_disponible: "45"
        - formato: pantalla
    - action: rutina_form
    - active_loop: rutina_form
    - slot_was_set:
        - musculo: pecho
    - slot_was_set:
        - nivel: intermedio
    - slot_was_set:
        - objetivo: fuerza
    - slot_was_set:
        - equipamiento: mancuernas
    - slot_was_set:
        - ejercicios_num: 7
    - slot_was_set:
        - tiempo_disponible: 45
    - slot_was_set:
        - formato: pantalla
    - action: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina

- story: rutina (otra rutina)
  steps:
    - intent: otra_rutina
    - action: rutina_form
    - active_loop: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina

# ───────── RUTINAS — CAMBIOS ESPECÍFICOS ─────────
- story: rutina (cambiar nivel)
  steps:
    - intent: cambiar_nivel_rutina
      entities:
        - nivel: avanzado
    - action: rutina_form
    - active_loop: rutina_form
    - slot_was_set:
        - nivel: avanzado
    - action: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina

- story: rutina (cambiar objetivo)
  steps:
    - intent: cambiar_objetivo_rutina
      entities:
        - objetivo: hipertrofia
    - action: rutina_form
    - active_loop: rutina_form
    - slot_was_set:
        - objetivo: hipertrofia
    - action: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina

- story: rutina (cambiar musculo)
  steps:
    - intent: cambiar_musculo_rutina
      entities:
        - musculo: espalda
    - action: rutina_form
    - active_loop: rutina_form
    - slot_was_set:
        - musculo: espalda
    - action: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina

# ───────── RUTINAS — FORMATO DE ENTREGA ─────────
- story: rutina formato pantalla
  steps:
    - intent: formato_entrega_rutina
      entities:
        - formato: pantalla
    - action: rutina_form
    - active_loop: rutina_form
    - slot_was_set:
        - formato: pantalla
    - action: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina

- story: rutina formato correo
  steps:
    - intent: formato_entrega_rutina
      entities:
        - formato: correo
    - action: rutina_form
    - active_loop: rutina_form
    - slot_was_set:
        - formato: correo
    - action: rutina_form
    - active_loop: null
    - action: utter_resumen_rutina
    - action: action_generar_rutina
    # No agregar más pasos: el post se decide por REGLAS

# ───────── PLANES DE SUSCRIPCIÓN ─────────
- story: plan cambio
  steps:
    - intent: suscripcion_cambio_plan
    - action: action_suscripcion_cambio_plan

# ───────── RESERVAS ─────────
- story: crear reserva (form + confirmar sí)
  steps:
    - intent: crear_reserva
    - action: reserva_form
    - active_loop: reserva_form
    - intent: informar
    - slot_was_set:
        - clase: spinning
    - action: reserva_form
    - intent: informar
    - slot_was_set:
        - fecha: 2025-10-05
    - action: reserva_form
    - intent: informar
    - slot_was_set:
        - hora: "07:00"
    - action: reserva_form
    - active_loop: null
    - action: utter_confirmar_reserva
    - intent: afirmar
    - action: action_crear_reserva
    - action: utter_reserva_confirmada

- story: cancelar reserva
  steps:
    - intent: cancelar_reserva
    - action: utter_ask_codigo_reserva
    - intent: informar
    - slot_was_set:
        - codigo_reserva: ABC123
    - action: action_cancelar_reserva
    - action: utter_reserva_cancelada

- story: consultar reserva
  steps:
    - intent: consultar_reserva
    - action: utter_ask_codigo_reserva
    - intent: informar
    - slot_was_set:
        - codigo_reserva: ABC123
    - action: action_consultar_reserva
    - action: utter_reserva_estado

# ───────── HIGIENE: marcar utter_ask_* y otras como "usadas" ─────────
- story: higiene_prompts_rutina
  steps:
    - action: utter_ask_musculo
    - action: utter_ask_nivel
    - action: utter_ask_objetivo
    - action: utter_ask_equipamiento
    - action: utter_ask_ejercicios_num
    - action: utter_ask_tiempo_disponible
    - action: utter_ask_formato

- story: higiene_otras_utters
  steps:
    - action: utter_consejo_nutricion
    - action: utter_suscripcion_cambio_plan
